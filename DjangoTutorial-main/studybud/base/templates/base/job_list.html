{% load static %}

<link rel="stylesheet" href="{% static 'css/jobFeed.css' %}">
<div class="job-container" id = "job-container">
    <div>
        <button class="swipeButton" id="leftButton">X</button>
    </div>

<<<<<<< HEAD

    

=======
    <!-- Loop through all jobs -->
>>>>>>> ea7eb1416d896cc87daabdcae8b6f37b4458c4f9
    {% for job in jobs %}
    <div class="job-item">
        {% if request.user == job.host %}
        <a href="{% url 'update-job' job.id %}">Edit</a>
        <a href="{% url 'delete-job' job.id %}">Delete</a>
        {% endif %}

        <a href="{% url 'user-profile' job.host.id %}">Company: {{ job.host.username }}</a>
        <h5>{{ job.id }} -- <a href="{% url 'job' job.id %}">Position: {{ job.name }}</a></h5>
        <small>{{ job.field.name }}</small>
        <hr>
    </div>
    {% endfor %}

<<<<<<< HEAD

=======
>>>>>>> ea7eb1416d896cc87daabdcae8b6f37b4458c4f9
    <div>
        <button class="swipeButton" id="rightButton">âœ“</button>
    </div>
</div>


<script>
// Variables
const jobItems = document.querySelectorAll('.job-item');
const denyBut = document.querySelector('#leftButton');
const acceptBut = document.querySelector('#rightButton');
const test = document.getElementById('Test');
let currentJobIndex = jobItems.length - 1;

// Initializing Buttons
denyBut.onclick = denyApp;
acceptBut.onclick = acceptApp;

jobItems[currentJobIndex].classList.add('active');

function denyApp() {
    jobItems[currentJobIndex].classList.remove('active');
    jobItems[currentJobIndex].remove();  
    
    currentJobIndex = (currentJobIndex + 1) % jobItems.length;
    jobItems[currentJobIndex].classList.add('active');
}
    

function acceptApp() {
<<<<<<< HEAD
    const currentJob = jobItems[currentJobIndex];
    const jobId = currentJob.querySelector('h5 a').getAttribute('href').split('/').pop();  // Extract job ID from URL

    // Send an AJAX request to add job ID to the user's job_applied field
    fetch('/add-job-applied/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value  // CSRF token for security
        },
        body: JSON.stringify({ job_id: jobId })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            console.log('Job ID added to user\'s job_applied');
        } else {
            console.log('Failed to add job ID');
        }

        // After the job is applied for, remove the current job item and show the next one
        currentJob.classList.remove('active');
        currentJob.remove();  // Also remove the element from DOM

        // If there are more job items, update the index and show the next job
        if (jobItems.length > 0) {
            currentJobIndex = (currentJobIndex + 1) % jobItems.length;
            jobItems[currentJobIndex].classList.add('active');
        } else {
            noJobs();  // If no jobs left, call your noJobs function (you can customize this)
        }
    })
    .catch(error => console.error('Error:', error));
}

</script>
=======
    jobItems[currentJobIndex].classList.remove('active');
    jobItems[currentJobIndex].remove();  
    currentJobIndex = (currentJobIndex + 1) % jobItems.length;
    jobItems[currentJobIndex].classList.add('active');    
}

</script>
>>>>>>> ea7eb1416d896cc87daabdcae8b6f37b4458c4f9
